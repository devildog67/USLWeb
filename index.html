<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Ultimate Survival Library | Resources for Preppers and Survivalists</title>
    <meta name="description" content="Explore comprehensive survival guides, prepping tips, food preservation techniques, and firearm safety resources at The Ultimate Survival Library. Your go-to source for all things survival.">
    <meta name="keywords" content="survival, prepping, food preservation, firearms, homesteading, survival guides, prepping tips, survival resources">   
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">    
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css?v=1.0.0" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js?v=1.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js?v=1.0.0"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js?v=1.0.0"></script>
    <style>
        body {
            background-color: #E8E8E8;
            color: #333333;
        }
        header {
            background-color: #6B8EAD;
        }
        nav {
            background-color: #333333;
        }
        .navbar-brand img {
            height: 30px;
            margin-right: 10px;
        }
        .card-header {
            background-color: #6B8EAD;
            color: #FFFFFF;
        }
        .card-header .btn-link {
            color: #FFFFFF;
            text-decoration: none;
        }
        .card-header .btn-link:hover {
            color: #FFD700;
        }
        .card-body {
            background-color: #FFFFFF;
            color: #333333;
        }
        .list-group-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #FFFFFF;
            color: #333333;
            border: 1px solid #E8E8E8;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }
        .list-group-item .link-container {
            flex-grow: 1;
            display: flex;
            align-items: center;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }
        .list-group-item .icon-container {
            display: flex;
            align-items: center;
        }
        .list-group-item .icon-container span,
        .list-group-item .icon-container a {
            margin-left: 10px;
            cursor: pointer;
        }
        .list-group-item .icon-container a {
            text-decoration: none;
        }
        .list-group-item .icon-container span:hover,
        .list-group-item .icon-container a:hover {
            color: #333333;
        }        
        .list-group-item a {
            flex-grow: 1;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }
        .save-icon {
            color: #6B8EAD;
            cursor: pointer;
            margin-left: 10px;
        }
        .save-icon:hover {
            color: #333333;
        }
        .delete-icon {
            color: #FF0000;
            cursor: pointer;
            margin-left: 10px;
        }
        .delete-icon:hover {
            color: #AA0000;
        }
        .info-icon {
            color: #6B8EAD;
            cursor: pointer;
            margin-left: 10px;
        }
        .info-icon:hover {
            color: #333333;
        }
        .btn-dark {
            background-color: #6B8EAD;
            border: none;
            color: #FFFFFF;
        }
        .btn-dark:hover {
            background-color: #333333;
            color: #FFFFFF;
        }
        .modal-header {
            background-color: #6B8EAD;
            color: #FFFFFF;
        }
        footer {
            background-color: #6B8EAD;
        }
        .favorites-sidebar {
            border-right: 2px solid #333333;
            padding-right: 20px;
        }
        .favorites-sidebar .card {
            margin-bottom: 1rem;
        }
        .container {
            max-width: 1600px;
        }
        .modal-body img {
            max-width: 100%;
            height: auto;
            margin-top: 10px;
        }
        .description {
            background-color: #FFFFFF;
            padding: 20px;
            border: 1px solid #E8E8E8;
            margin-top: 20px;
            font-size: 1.1em;
        }
        .social-icons {
            margin-top: 10px;
        }
        .social-icon {
            margin: 0 10px;
            color: #FFFFFF;
            font-size: 24px;
            text-decoration: none;
        }
        .social-icon:hover {
            color: #FFD700; /* Change this color to whatever you like */
        }
    </style>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-0NZ83R0M14"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0NZ83R0M14');
</script>
<body>
    <header class="text-white text-center py-3">
        <h1>The Ultimate Survival Library Web</h1>
    </header>    
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="https://www.uslweb.com"><img src="USLWebLogo2.png" alt="Logo">USL Web</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto" id="navbarNavList">
                    <li class="nav-item"><a class="nav-link" href="https://www.uslweb.com">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="privacypolicy.html">Privacy Policy</a></li>
                    <li class="nav-item"><a class="nav-link" href="extension.html">USL Web Extension</a></li>
                    <li class="nav-item"><a class="nav-link" href="downloads.html">Downloads</a></li>
                    <li class="nav-item"><a class="nav-link" href="contact.html">Contact Us</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container description">
        Welcome to The Ultimate Survival Library Web (USL Web), your ultimate collection of curated links related to survival and prepping. Explore resources on general survival tips, food preservation, firearms, homesteading, and more. Whether you're a seasoned prepper or just starting out, our comprehensive library will help you find the best information and tools to enhance your preparedness. Join our community and start building your survival skills today.
    </div>   
    <div class="container">
        <div class="row">
            <div class="col-md-3 favorites-sidebar">
                <div class="card">
                    <div class="card-header">
                        <h3>Favorites</h3>
                    </div>
                    <div class="card-body">
                        <ul class="list-group" id="favoritesList"></ul>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="input-group mb-3">
                    <input type="text" id="filterInput" class="form-control" placeholder="Filter links...">
                    <div class="input-group-append">
                        <button id="clearFilterButton" class="btn btn-outline-secondary" type="button">Clear</button>
                    </div>
                </div>                
                <div id="accordion">
                    <!-- Accordion items will be generated dynamically -->
                </div>
            </div>
            <div class="col-md-3">
                <section class="submit-section mt-0">
                    <div class="card">
                        <div class="card-header">
                            <h3>Submit a Recommended Website</h3>
                        </div>
                        <div class="card-body">
                            <p>Please email questions or recommended websites to <a href="mailto:info@uslweb.com">info@uslweb.com</a>.</p>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
    <!-- Add this in the section where you want to display the social media icons, for example in the footer -->
    <footer class="text-white text-center py-3 mt-5">
        <p>&copy; 2024 The Ultimate Survival Library Web. All rights reserved.</p>        
        <div class="social-icons">
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://www.uslweb.com" target="_blank" class="social-icon">
                <i class="fab fa-facebook-f"></i>
            </a>
            <a href="https://twitter.com/intent/tweet?url=https://www.uslweb.com&text=Check%20out%20this%20amazing%20survival%20resource!" target="_blank" class="social-icon">
                <i class="fab fa-twitter"></i>
            </a>
            <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://www.uslweb.com" target="_blank" class="social-icon">
                <i class="fab fa-linkedin-in"></i>
            </a>
            <a href="mailto:?subject=Check out this site&body=Check out this amazing survival resource: https://www.uslweb.com" target="_blank" class="social-icon">
                <i class="fas fa-envelope"></i>
            </a>
        </div>
    </footer>

    <!-- Bootstrap Modal for Website Descriptions -->
    <div class="modal fade" id="descriptionModal" tabindex="-1" role="dialog" aria-labelledby="descriptionModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="descriptionModalLabel">Website Description</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="descriptionContent"></div>
                    <div id="descriptionImage"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
            loadResources();
        });

        // Handle navbar link clicks to open corresponding panel bar and scroll to it
        document.querySelectorAll('.navbar-nav .nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                const targetCollapse = this.getAttribute('data-target');
                
                // Only prevent default behavior if there is a data-target attribute
                if (targetCollapse) {
                    e.preventDefault();
                    const targetElement = document.querySelector(targetCollapse);

                    if (targetElement) {
                        // Close all other collapse elements
                        $('.collapse.show').collapse('hide').on('hidden.bs.collapse', function() {
                            // Remove the event listener to avoid re-opening issues
                            $(this).off('hidden.bs.collapse');
                            // Open the clicked collapse element
                            $(targetCollapse).collapse('show');
                            targetElement.scrollIntoView({ behavior: 'smooth' });
                        });

                        // If there are no open collapse elements, open the target collapse element immediately
                        if ($('.collapse.show').length === 0) {
                            $(targetCollapse).collapse('show');
                            targetElement.scrollIntoView({ behavior: 'smooth' });
                        }
                    }
                }
            });
        });


        function loadResources() {
            fetch('fetch_data.php')
                .then(response => response.json())
                .then(data => {
                    const categories = Object.keys(data);
                    const accordion = document.getElementById('accordion');

                    categories.forEach((category) => {
                        // Create Accordion item
                        const card = document.createElement('div');
                        card.className = 'card';
                        
                        const cardHeader = document.createElement('div');
                        cardHeader.className = 'card-header';
                        cardHeader.id = `heading${category}`;
                        cardHeader.innerHTML = `
                            <h2 class="mb-0">
                                <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapse${category}" aria-expanded="false" aria-controls="collapse${category}">
                                    ${category}
                                </button>
                            </h2>`;
                        card.appendChild(cardHeader);

                        const collapseDiv = document.createElement('div');
                        collapseDiv.id = `collapse${category}`;
                        collapseDiv.className = 'collapse';
                        collapseDiv.setAttribute('aria-labelledby', `heading${category}`);
                        collapseDiv.setAttribute('data-parent', '#accordion');

                        const cardBody = document.createElement('div');
                        cardBody.className = 'card-body';
                        const listGroup = document.createElement('ul');
                        listGroup.className = 'list-group';
                        listGroup.id = `${category.toLowerCase()}List`;

                        data[category].forEach(site => {
                            const listItem = document.createElement('li');
                            listItem.className = 'list-group-item';
                            listItem.dataset.description = site.description || '';
                            listItem.dataset.screenshot = site.screenshot || '';

                            const linkContainer = document.createElement('div');
                            linkContainer.className = 'link-container';

                            const iconImg = document.createElement('img');
                            iconImg.style.width = '16px';
                            iconImg.style.height = '16px';
                            iconImg.style.marginRight = '10px';
                            iconImg.src = site.favicon || 'images/default.ico'; // Use provided favicon or default icon
                            linkContainer.appendChild(iconImg);

                            const link = document.createElement('a');
                            link.href = site.url;
                            link.textContent = site.title;
                            link.target = '_blank';
                            linkContainer.appendChild(link);

                            listItem.appendChild(linkContainer);

                            const iconContainer = document.createElement('div');
                            iconContainer.className = 'icon-container';

                            if (site.description && site.description.trim() !== '') {
                                const infoIcon = document.createElement('span');
                                infoIcon.className = 'info-icon';
                                infoIcon.innerHTML = 'ℹ️';
                                infoIcon.setAttribute('data-toggle', 'tooltip');
                                infoIcon.setAttribute('title', 'More information about Website');
                                infoIcon.addEventListener('click', () => showDescription(site.description, site.screenshot));
                                iconContainer.appendChild(infoIcon);
                            }

                            const saveIcon = document.createElement('span');
                            saveIcon.className = 'save-icon';
                            saveIcon.innerHTML = '💾';
                            saveIcon.setAttribute('data-toggle', 'tooltip');
                            saveIcon.setAttribute('title', 'Save to Favorites');
                            saveIcon.addEventListener('click', () => addToFavorites(site.title, site.url));
                            iconContainer.appendChild(saveIcon);

                            const relatedIcon = document.createElement('span');
                            relatedIcon.className = 'related-icon';
                            relatedIcon.innerHTML = '🔗';
                            relatedIcon.setAttribute('data-toggle', 'tooltip');
                            relatedIcon.setAttribute('title', 'Find Related Pages');
                            const relatedLink = document.createElement('a');
                            relatedLink.href = `https://www.google.com/search?q=related:${site.url}`;
                            relatedLink.target = '_blank';
                            relatedLink.appendChild(relatedIcon);
                            iconContainer.appendChild(relatedLink);

                            listItem.appendChild(iconContainer);

                            listGroup.appendChild(listItem);
                        });

                        cardBody.appendChild(listGroup);
                        collapseDiv.appendChild(cardBody);
                        card.appendChild(collapseDiv);
                        accordion.appendChild(card);
                    });
                })
                .catch(error => console.error('Error fetching data:', error));
        }

        function showDescription(description, screenshot) {
            document.getElementById('descriptionContent').innerText = description;
            const descriptionImage = document.getElementById('descriptionImage');
            descriptionImage.innerHTML = '';  // Clear any existing content

            if (screenshot && screenshot.trim() !== '') {
                const imgElement = document.createElement('img');
                imgElement.src = screenshot;
                imgElement.alt = "Screenshot";
                imgElement.style.maxWidth = "100%";
                imgElement.style.height = "auto";
                descriptionImage.appendChild(imgElement);
            }

            $('#descriptionModal').modal('show');
        }

        function addToFavorites(title, url) {
            const favoritesList = document.getElementById('favoritesList');
            const listItem = document.createElement('li');
            listItem.className = 'list-group-item';

            const link = document.createElement('a');
            link.href = url;
            link.textContent = title;
            link.target = '_blank';
            listItem.appendChild(link);

            const deleteIcon = document.createElement('span');
            deleteIcon.className = 'delete-icon ml-2';
            deleteIcon.innerHTML = '🗑️';
            deleteIcon.setAttribute('data-toggle', 'tooltip');
            deleteIcon.setAttribute('title', 'Remove from Favorites');
            deleteIcon.addEventListener('click', () => removeFromFavorites(listItem));
            listItem.appendChild(deleteIcon);

            favoritesList.appendChild(listItem);
            saveFavorites();
        }

        function removeFromFavorites(listItem) {
            const favoritesList = document.getElementById('favoritesList');
            favoritesList.removeChild(listItem);
            saveFavorites();
        }

        function saveFavorites() {
            const favorites = [];
            document.querySelectorAll('#favoritesList .list-group-item').forEach(item => {
                const link = item.querySelector('a');
                favorites.push({ title: link.textContent, url: link.href });
            });
            localStorage.setItem('favorites', JSON.stringify(favorites));
        }

        function loadFavorites() {
            const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
            const favoritesList = document.getElementById('favoritesList');
            favorites.forEach(site => {
                const listItem = document.createElement('li');
                listItem.className = 'list-group-item';

                const link = document.createElement('a');
                link.href = site.url;
                link.textContent = site.title;
                link.target = '_blank';
                listItem.appendChild(link);

                const deleteIcon = document.createElement('span');
                deleteIcon.className = 'delete-icon ml-2';
                deleteIcon.innerHTML = '🗑️';
                deleteIcon.addEventListener('click', () => removeFromFavorites(listItem));
                listItem.appendChild(deleteIcon);

                favoritesList.appendChild(listItem);
            });
        }

        // Load favorites from localStorage when the page loads
        window.addEventListener('load', loadFavorites);

        // Save favorites to localStorage when the page is unloaded
        window.addEventListener('beforeunload', saveFavorites);

        document.getElementById('clearFilterButton').addEventListener('click', function() {
            document.getElementById('filterInput').value = '';
            const filterEvent = new Event('input');
            document.getElementById('filterInput').dispatchEvent(filterEvent);
        });

        document.getElementById('filterInput').addEventListener('input', function() {
            const filterValue = this.value.toLowerCase();
            const listGroups = document.querySelectorAll('.list-group');

            listGroups.forEach(group => {
                if (group.id === 'favoritesList') return;

                const listItems = group.querySelectorAll('.list-group-item');
                let hasVisibleItems = false;

                listItems.forEach(item => {
                    const descriptionText = item.dataset.description.toLowerCase();
                    if (descriptionText.includes(filterValue)) {
                        item.style.display = '';
                        hasVisibleItems = true;
                    } else {
                        item.style.display = 'none';
                    }
                });

                const card = group.closest('.card');
                if (hasVisibleItems) {
                    card.style.display = '';
                } else {
                    card.style.display = 'none';
                }
            });
        });
    </script>    
</body>
</html>
